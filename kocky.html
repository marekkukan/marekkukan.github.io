<!DOCTYPE html>
<html>
<head>
<meta name="theme-color" content="#cdabef">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon192.png">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<style>
body {
  width: 100%;
  height: 100%;
  margin: 0;
  overflow: hidden;
}
#myCanvas {
  background-color: lightgrey;
  width: 100%;
  height: 100%;
  display: block;
}
</style>
</head>
<body>
<ul style="list-style-type: none;">
  <li style="float: left;"><button onclick="displayGraph('2020')">2020</button></li>
  <li style="float: left;"><button onclick="displayGraph('2021')">2021</button></li>
</ul>
<canvas id="myCanvas">
Your browser does not support the HTML5 canvas tag.</canvas>
<script>
var dx = 12;
var sx = 10;
var sy = 600;
var my = 15;
var colors = [
    '#0000FF', //blue
    '#FF0000', //red
    '#FFEE00', //yellow
    '#008000', //green
    '#FFA500', // orange
    '#800080', //purple
    '#808000', //olive
    '#00FF00', //lime
    '#800000', //maroon
    '#00FFFF', //aqua
    '#008080', //team
    '#000080', //navy
    '#FF00FF', //fushua
    '#808080', //gray
    '#abcdef',
    '#cdabef',
    '#cdefab',
    '#efabcd',
    '#efcdab'
];
colors = colors.concat(colors);
var canvas = document.getElementById("myCanvas");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
var ctx = canvas.getContext("2d");

function displayGraph(season) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillText('window: ' + window.innerWidth + ' x ' + window.innerHeight, 10, 20);
  ctx.fillText('screen: ' + window.screen.width + ' x ' + window.screen.height, 10, 30);
  ctx.font = 'bold 10px sans-serif';
  var url;
  if (season == "2020") url = "https://sheets.googleapis.com/v4/spreadsheets/1SMSHgI_VwedJJFKElNIdlErG83lAum5I2SvgElYS6eU/values/body!B1:R100?key=AIzaSyCLvFHhl5l1iNKv2PaJM7n8eSftTCX8OTE";
  if (season == "2021") url = "https://sheets.googleapis.com/v4/spreadsheets/1ffUJY2jo2mX_1tJ1OmZ_Dxp41sEBthG6KEEjwTsXS0M/values/body!B1:Z100?key=AIzaSyCLvFHhl5l1iNKv2PaJM7n8eSftTCX8OTE";
  $.get(
    url,
    {majorDimension: "COLUMNS"},
    function(data) {
        c = 0;
        labels = [];
        for (column of data.values) {
            c %= colors.length;
            ctx.strokeStyle = colors[c++];
            ctx.fillStyle = ctx.strokeStyle;
            ctx.lineWidth = 4;
            var x = sx;
            var y = sy;
            var started = false;
            for (i of column.slice(2)) {
                if (!started && i == "") {
                  x += dx;
                  continue;
                }
                if (!started) {
                  ctx.beginPath();
                  ctx.arc(x, y, 6, 0, 2 * Math.PI);
                  ctx.fill();
                  started = true;
                }
                ctx.beginPath();
                ctx.moveTo(x, y);
                ctx.setLineDash([]);
                if (i == "") {
                    i = "0";
                    ctx.setLineDash([1, 3]);
                }
                x = x + dx;
                y = y - my*parseFloat(i);
                ctx.lineTo(x, y);
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(x, y, 2, 0, 2 * Math.PI);
                ctx.fill();
            }
            labels.push([column[0] + ' (' + (sy-y)/my + ')', x+5, y+5]);
        }
        ctx.fillStyle = 'black';
        for (x of labels) {
            ctx.fillText(x[0], x[1], x[2]);
        }
    }
  );
}

displayGraph("2021");
</script>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').then(() => { console.log('SW Registered'); });
}
</script>
</body>
</html>
